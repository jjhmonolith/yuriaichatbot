# EduChat AI í•™ìŠµ ì‹œìŠ¤í…œ - ê¸°ìˆ  ë¬¸ì„œ
## ğŸ—ï¸ ì‹œìŠ¤í…œ ì•„í‚¤í…ì²˜ ë° ê¸°ìˆ  ëª…ì„¸

---

## ğŸ“‹ ëª©ì°¨
1. [ì‹œìŠ¤í…œ ê°œìš”](#ì‹œìŠ¤í…œ-ê°œìš”)
2. [ì•„í‚¤í…ì²˜ êµ¬ì¡°](#ì•„í‚¤í…ì²˜-êµ¬ì¡°)
3. [ê¸°ìˆ  ìŠ¤íƒ](#ê¸°ìˆ -ìŠ¤íƒ)
4. [ë°ì´í„°ë² ì´ìŠ¤ ì„¤ê³„](#ë°ì´í„°ë² ì´ìŠ¤-ì„¤ê³„)
5. [API ëª…ì„¸](#api-ëª…ì„¸)
6. [ë³´ì•ˆ ë° ì„±ëŠ¥](#ë³´ì•ˆ-ë°-ì„±ëŠ¥)
7. [ë°°í¬ ë° ì¸í”„ë¼](#ë°°í¬-ë°-ì¸í”„ë¼)
8. [ê°œë°œ í™˜ê²½](#ê°œë°œ-í™˜ê²½)

---

## ğŸ¯ ì‹œìŠ¤í…œ ê°œìš”

### í•µì‹¬ ì•„í‚¤í…ì²˜
```
[í•™ìƒ ë””ë°”ì´ìŠ¤] â†â†’ [Frontend] â†â†’ [Backend API] â†â†’ [MongoDB]
                              â†“
                         [OpenAI API]
```

### ì‹œìŠ¤í…œ êµ¬ì„± ìš”ì†Œ

- **Frontend**: Next.js ê¸°ë°˜ React ì›¹ ì• í”Œë¦¬ì¼€ì´ì…˜
- **Backend**: Express.js ê¸°ë°˜ RESTful API ì„œë²„
- **Database**: MongoDB Atlas (í´ë¼ìš°ë“œ ë°ì´í„°ë² ì´ìŠ¤)
- **AI Engine**: OpenAI GPT ëª¨ë¸ í†µí•©
- **Storage**: í´ë¼ì´ì–¸íŠ¸ ì‚¬ì´ë“œ localStorage (ì±„íŒ… ë°ì´í„°)

---

## ğŸ—ï¸ ì•„í‚¤í…ì²˜ êµ¬ì¡°

### ğŸ“± **Client-Side Architecture**

```mermaid
graph TD
    A[QR Code Scan] --> B[Web Browser]
    B --> C[Next.js App]
    C --> D[React Components]
    D --> E[Custom Hooks]
    E --> F[API Layer]
    F --> G[LocalStorage]
```

#### ì£¼ìš” ì»´í¬ë„ŒíŠ¸
- **Chat Interface**: ì‹¤ì‹œê°„ ë©”ì‹œì§€ êµí™˜ UI
- **Admin Dashboard**: ê´€ë¦¬ì ì½˜í…ì¸  ê´€ë¦¬ ì¸í„°í˜ì´ìŠ¤
- **QR Code Router**: QR ì½”ë“œ ê¸°ë°˜ ë¼ìš°íŒ… ì‹œìŠ¤í…œ

### ğŸ–¥ï¸ **Server-Side Architecture**

```mermaid
graph TD
    A[Express.js Server] --> B[Route Handlers]
    B --> C[Controller Layer]
    C --> D[Service Layer]
    D --> E[Model Layer]
    E --> F[MongoDB Database]
    C --> G[OpenAI API]
```

#### ë ˆì´ì–´ êµ¬ì¡°
- **Route Layer**: HTTP ì—”ë“œí¬ì¸íŠ¸ ì •ì˜
- **Controller Layer**: ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ ì²˜ë¦¬
- **Service Layer**: ì™¸ë¶€ API í†µí•© (OpenAI)
- **Model Layer**: ë°ì´í„° ìŠ¤í‚¤ë§ˆ ë° ê²€ì¦
- **Database Layer**: MongoDB ë°ì´í„° ì˜ì†ì„±

---

## ğŸ’» ê¸°ìˆ  ìŠ¤íƒ

### **Frontend Stack**
```yaml
Framework: Next.js 15.3.5
Language: TypeScript 5.x
UI Library: React 18.x
Styling: Tailwind CSS 3.x
Icons: Lucide React
Markdown: ReactMarkdown
State Management: React Hooks + Custom Hooks
HTTP Client: Fetch API
```

### **Backend Stack**
```yaml
Runtime: Node.js 18.x+
Framework: Express.js 4.x
Language: TypeScript 5.x
Database ODM: Mongoose 8.x
Authentication: Custom middleware
Validation: Mongoose built-in validators
AI Integration: OpenAI API 4.x
Environment: dotenv
```

### **Database & Infrastructure**
```yaml
Database: MongoDB Atlas (Cloud)
File Storage: Local filesystem (QR codes)
CDN: Vercel Edge Network
Container: Railway (Backend hosting)
Monitoring: Built-in logging
```

---

## ğŸ—„ï¸ ë°ì´í„°ë² ì´ìŠ¤ ì„¤ê³„

### **Core Collections**

#### ğŸ“š **Textbooks** (êµì¬)
```typescript
interface ITextbook {
  _id: ObjectId;
  title: string;          // êµì¬ëª…
  publisher: string;      // ì¶œíŒì‚¬
  subject: string;        // ê³¼ëª© (êµ­ì–´, ë¬¸í•™ ë“±)
  level: string;          // í•™ë…„ (ê³ 1, ê³ 2, ê³ 3)
  grade: string;          // í•™ê¸°
  createdAt: Date;
  updatedAt: Date;
}
```

#### ğŸ“„ **PassageSets** (ì§€ë¬¸ì„¸íŠ¸)
```typescript
interface IPassageSet {
  _id: ObjectId;
  title: string;               // ì§€ë¬¸ ì œëª©
  passage: string;             // ì§€ë¬¸ ë‚´ìš©
  passageComment: string;      // ì§€ë¬¸ í•´ì„¤
  qrCode: string;             // ê³ ìœ  QR ì½”ë“œ (6ìë¦¬)
  textbooks: ObjectId[];      // ì—°ê²°ëœ êµì¬ë“¤
  createdAt: Date;
  updatedAt: Date;
}
```

#### â“ **Questions** (ë¬¸ì œ)
```typescript
interface IQuestion {
  _id: ObjectId;
  setId: ObjectId;            // ì§€ë¬¸ì„¸íŠ¸ ì°¸ì¡°
  questionNumber: number;     // ë¬¸ì œ ë²ˆí˜¸
  questionText: string;       // ë¬¸ì œ ë‚´ìš©
  options: string[];          // ì„ íƒì§€ ë°°ì—´
  correctAnswer: string;      // ì •ë‹µ
  explanation: string;        // í•´ì„¤ (ë§ˆí¬ë‹¤ìš´)
  createdAt: Date;
  updatedAt: Date;
}
```

#### ğŸ¤– **SystemPrompts** (ì‹œìŠ¤í…œ í”„ë¡¬í”„íŠ¸)
```typescript
interface ISystemPrompt {
  _id: ObjectId;
  key: string;               // í”„ë¡¬í”„íŠ¸ ì‹ë³„ì
  name: string;              // í‘œì‹œëª…
  description: string;       // ì„¤ëª…
  content: string;           // í”„ë¡¬í”„íŠ¸ ë‚´ìš©
  isActive: boolean;         // í™œì„±í™” ì—¬ë¶€
  version: number;           // ë²„ì „ ë²ˆí˜¸
  createdAt: Date;
  updatedAt: Date;
}
```

#### ğŸ“ **SystemPromptVersions** (í”„ë¡¬í”„íŠ¸ ë²„ì „ íˆìŠ¤í† ë¦¬)
```typescript
interface ISystemPromptVersion {
  _id: ObjectId;
  promptKey: string;         // ì›ë³¸ í”„ë¡¬í”„íŠ¸ í‚¤
  content: string;           // í•´ë‹¹ ë²„ì „ ë‚´ìš©
  version: number;           // ë²„ì „ ë²ˆí˜¸
  description: string;       // ë²„ì „ ì„¤ëª…
  createdBy: string;         // ìƒì„±ì
  createdAt: Date;
}
```

### **Indexes**
```javascript
// ì„±ëŠ¥ ìµœì í™”ë¥¼ ìœ„í•œ ì¸ë±ìŠ¤
db.passagesets.createIndex({ "qrCode": 1 }, { unique: true });
db.questions.createIndex({ "setId": 1, "questionNumber": 1 }, { unique: true });
db.systemprompts.createIndex({ "key": 1, "isActive": 1 });
db.systemprompversions.createIndex({ "promptKey": 1, "version": -1 });
```

---

## ğŸ”Œ API ëª…ì„¸

### **Base URL**
```
Production: https://yuriaichatbot-production-1f9d.up.railway.app/api
Development: http://localhost:3001/api
```

### **Core Endpoints**

#### ğŸ—£ï¸ **Chat API**
```http
POST /chat/:qrCode
Content-Type: application/json

{
  "message": "ì‚¬ìš©ì ì§ˆë¬¸"
}

Response:
{
  "success": true,
  "data": {
    "response": "AI ì‘ë‹µ ë©”ì‹œì§€"
  }
}
```

#### ğŸ“Š **Admin Dashboard API**
```http
GET /admin/dashboard/stats
Response:
{
  "success": true,
  "data": {
    "stats": [
      {
        "name": "ì´ êµì¬",
        "value": "12",
        "change": "+2",
        "changeType": "positive"
      }
    ]
  }
}

GET /admin/dashboard/recent-activity
Response:
{
  "success": true,
  "data": {
    "activities": [
      {
        "type": "textbook",
        "action": "created",
        "title": "ê³ ë“± ë¬¸í•™",
        "timestamp": "2025-07-12T10:30:00Z",
        "description": "ìƒˆ êµì¬ \"ê³ ë“± ë¬¸í•™\" ì¶”ê°€ë¨"
      }
    ]
  }
}
```

#### ğŸ“š **Content Management APIs**

**êµì¬ ê´€ë¦¬**
```http
GET    /admin/textbooks           # êµì¬ ëª©ë¡ ì¡°íšŒ
POST   /admin/textbooks           # ìƒˆ êµì¬ ìƒì„±
GET    /admin/textbooks/:id       # íŠ¹ì • êµì¬ ì¡°íšŒ
PUT    /admin/textbooks/:id       # êµì¬ ìˆ˜ì •
DELETE /admin/textbooks/:id       # êµì¬ ì‚­ì œ
```

**ì§€ë¬¸ì„¸íŠ¸ ê´€ë¦¬**
```http
GET    /admin/passage-sets         # ì§€ë¬¸ì„¸íŠ¸ ëª©ë¡
POST   /admin/passage-sets         # ìƒˆ ì§€ë¬¸ì„¸íŠ¸ ìƒì„±
GET    /admin/passage-sets/:id     # íŠ¹ì • ì§€ë¬¸ì„¸íŠ¸ ì¡°íšŒ
PUT    /admin/passage-sets/:id     # ì§€ë¬¸ì„¸íŠ¸ ìˆ˜ì •
DELETE /admin/passage-sets/:id     # ì§€ë¬¸ì„¸íŠ¸ ì‚­ì œ
POST   /admin/passage-sets/:id/regenerate-qr  # QR ì½”ë“œ ì¬ìƒì„±
```

**ë¬¸ì œ ê´€ë¦¬**
```http
GET    /admin/sets/:setId/questions    # ì§€ë¬¸ì„¸íŠ¸ë³„ ë¬¸ì œ ëª©ë¡
POST   /admin/sets/:setId/questions    # ìƒˆ ë¬¸ì œ ìƒì„±
PUT    /admin/questions/:id            # ë¬¸ì œ ìˆ˜ì •
DELETE /admin/questions/:id            # ë¬¸ì œ ì‚­ì œ
```

#### ğŸ¤– **AI Content Generation APIs**
```http
POST /admin/commentary-generator/generate
Content-Type: application/json

{
  "title": "ì§€ë¬¸ ì œëª©",
  "passage": "ì§€ë¬¸ ë‚´ìš©",
  "existingCommentary": "ê¸°ì¡´ í•´ì„¤ (ì„ íƒ)",
  "subject": "êµ­ì–´",
  "level": "ê³ ë“±í•™êµ"
}

POST /admin/commentary-generator/generate-question
Content-Type: application/json

{
  "passageContent": "ì§€ë¬¸ ë‚´ìš©",
  "questionText": "ë¬¸ì œ ë‚´ìš©",
  "options": ["ì„ íƒì§€1", "ì„ íƒì§€2", "ì„ íƒì§€3", "ì„ íƒì§€4"],
  "correctAnswer": "ì •ë‹µ",
  "existingExplanation": "ê¸°ì¡´ í•´ì„¤ (ì„ íƒ)"
}
```

#### âš™ï¸ **System Prompt Management**
```http
GET    /admin/system-prompts                    # í”„ë¡¬í”„íŠ¸ ëª©ë¡
PUT    /admin/system-prompts/:id                # í”„ë¡¬í”„íŠ¸ ìˆ˜ì •
GET    /admin/system-prompts/versions/:key      # ë²„ì „ íˆìŠ¤í† ë¦¬
POST   /admin/system-prompts/revert/:key        # ë²„ì „ ë˜ëŒë¦¬ê¸°
```

---

## ğŸ” ë³´ì•ˆ ë° ì„±ëŠ¥

### **ë³´ì•ˆ ì¡°ì¹˜**

#### API ë³´ì•ˆ
```typescript
// CORS ì„¤ì •
app.use(cors({
  origin: process.env.FRONTEND_URL,
  credentials: true
}));

// Rate Limiting (ë¯¸êµ¬í˜„)
// Helmet ë³´ì•ˆ í—¤ë” (ë¯¸êµ¬í˜„)
// API Key ì¸ì¦ (OpenAIë§Œ ì ìš©)
```

#### ë°ì´í„° ë³´ì•ˆ
- MongoDB Atlas ì•”í˜¸í™” ì—°ê²°
- í™˜ê²½ ë³€ìˆ˜ë¥¼ í†µí•œ ë¯¼ê° ì •ë³´ ê´€ë¦¬
- í´ë¼ì´ì–¸íŠ¸ ì‚¬ì´ë“œ ì±„íŒ… ë°ì´í„° ì €ì¥ (ê°œì¸ì •ë³´ ë¯¸ìˆ˜ì§‘)

### **ì„±ëŠ¥ ìµœì í™”**

#### í”„ë¡ íŠ¸ì—”ë“œ
```typescript
// Next.js ìµœì í™”
- Static Site Generation (SSG)
- Code Splitting
- Image Optimization
- Lazy Loading

// ì‚¬ìš©ì ê²½í—˜
- Loading States
- Error Boundaries
- Optimistic Updates
```

#### ë°±ì—”ë“œ
```typescript
// MongoDB ìµœì í™”
- ì¸ë±ìŠ¤ í™œìš©
- Aggregation Pipeline
- Connection Pooling

// API ì„±ëŠ¥
- Response Compression
- Caching Headers
- Pagination
```

---

## ğŸš€ ë°°í¬ ë° ì¸í”„ë¼

### **Production Environment**

#### Frontend Deployment (Vercel)
```yaml
Platform: Vercel
Domain: https://yuriaichatbot-frontend.vercel.app
Features:
  - Automatic Git deployment
  - Edge Network CDN
  - Serverless Functions
  - SSL Certificate
```

#### Backend Deployment (Railway)
```yaml
Platform: Railway
Domain: https://yuriaichatbot-production-1f9d.up.railway.app
Features:
  - Container-based deployment
  - Auto-scaling
  - Environment variables
  - SSL Certificate
```

#### Database (MongoDB Atlas)
```yaml
Provider: MongoDB Atlas
Cluster: M0 Sandbox (Free Tier)
Region: AWS ap-southeast-1 (Singapore)
Features:
  - Automatic backups
  - SSL encryption
  - IP whitelist security
```

### **CI/CD Pipeline**
```mermaid
graph LR
    A[Git Push] --> B[GitHub]
    B --> C[Vercel Auto Deploy]
    B --> D[Railway Auto Deploy]
    C --> E[Frontend Live]
    D --> F[Backend Live]
```

---

## ğŸ› ï¸ ê°œë°œ í™˜ê²½

### **Local Setup**
```bash
# í”„ë¡œì íŠ¸ í´ë¡ 
git clone https://github.com/jjhmonolith/yuriaichatbot.git

# ë°±ì—”ë“œ ì„¤ì •
cd backend
npm install
cp .env.example .env  # í™˜ê²½ ë³€ìˆ˜ ì„¤ì •
npm run dev

# í”„ë¡ íŠ¸ì—”ë“œ ì„¤ì •
cd ../frontend
npm install
cp .env.local.example .env.local  # í™˜ê²½ ë³€ìˆ˜ ì„¤ì •
npm run dev
```

### **í™˜ê²½ ë³€ìˆ˜**

#### Backend (.env)
```bash
PORT=3001
MONGODB_URI=mongodb+srv://...
OPENAI_API_KEY=sk-...
FRONTEND_URL=http://localhost:3000
NODE_ENV=development
```

#### Frontend (.env.local)
```bash
NEXT_PUBLIC_API_URL=http://localhost:3001/api
```

### **ê°œë°œ ë„êµ¬**
```yaml
IDE: VS Code (ê¶Œì¥)
Extensions:
  - TypeScript
  - Tailwind CSS IntelliSense
  - MongoDB for VS Code
  - REST Client

Package Managers:
  - npm (í”„ë¡ íŠ¸ì—”ë“œ/ë°±ì—”ë“œ)
  
Version Control:
  - Git + GitHub
```

---

## ğŸ“Š ëª¨ë‹ˆí„°ë§ ë° ë¡œê¹…

### **ë¡œê¹… ì‹œìŠ¤í…œ**
```typescript
// Backend Logging
console.log() // ê¸°ë³¸ ì½˜ì†” ë¡œê¹…
// Production: Railway ë‚´ì¥ ë¡œê¹… ì‹œìŠ¤í…œ

// Frontend Logging
console.error() // ì—ëŸ¬ ë¡œê¹…
// Production: ë¸Œë¼ìš°ì € ê°œë°œì ë„êµ¬
```

### **ì„±ëŠ¥ ëª¨ë‹ˆí„°ë§**
```yaml
Frontend:
  - Vercel Analytics (ê¸°ë³¸)
  - Core Web Vitals ì¶”ì 

Backend:
  - Railway ë‚´ì¥ ë©”íŠ¸ë¦­
  - API ì‘ë‹µ ì‹œê°„ ì¸¡ì •
  - ì—ëŸ¬ìœ¨ ì¶”ì 
```

---

## ğŸ”„ í™•ì¥ ê³„íš

### **ë‹¨ê¸° ê³„íš (3ê°œì›”)**
- ì‚¬ìš©ì ì¸ì¦ ì‹œìŠ¤í…œ êµ¬í˜„
- ì±„íŒ… ë¡œê·¸ ì„œë²„ ì €ì¥
- í•™ìŠµ ë¶„ì„ ëŒ€ì‹œë³´ë“œ

### **ì¤‘ê¸° ê³„íš (6ê°œì›”)**
- ë‹¤ì¤‘ ê³¼ëª© ì§€ì› (ì˜ì–´, ìˆ˜í•™)
- ëª¨ë°”ì¼ ì•± ê°œë°œ
- ê³ ê¸‰ AI ëª¨ë¸ í†µí•©

### **ì¥ê¸° ê³„íš (1ë…„)**
- ë¨¸ì‹ ëŸ¬ë‹ ê¸°ë°˜ ê°œì¸í™”
- ì‹¤ì‹œê°„ í˜‘ì—… ê¸°ëŠ¥
- êµìœ¡ê¸°ê´€ ì—°ë™ API

---

## ğŸ“ ê¸°ìˆ  ì§€ì›

### **ë¬¸ì„œ ë° ë¦¬ì†ŒìŠ¤**
- GitHub Repository: https://github.com/jjhmonolith/yuriaichatbot
- API Documentation: /docs/api-spec.md
- Deployment Guide: /docs/deployment.md

### **ì—°ë½ì²˜**
- ê¸°ìˆ  ì±…ì„ì: ê°œë°œíŒ€
- ì´ë©”ì¼: dev@educhat.kr
- ì´ìŠˆ íŠ¸ë˜í‚¹: GitHub Issues

---

*EduChat AI ì‹œìŠ¤í…œì˜ ê¸°ìˆ ì  ì„¸ë¶€ì‚¬í•­ì— ëŒ€í•´ ì¶”ê°€ ë¬¸ì˜ì‚¬í•­ì´ ìˆìœ¼ì‹œë©´ ì–¸ì œë“  ì—°ë½í•´ ì£¼ì„¸ìš”.* ğŸš€